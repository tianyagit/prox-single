{template 'common/header'}
<ol class="breadcrumb we7-breadcrumb">
    <a href="{php echo url('site/article')}"><i class="wi wi-back-circle"></i> </a>
    <li><a href="{php echo url('site/article')}">文章管理</a></li>
    <li><a href="{php echo url('site/article/post')}">文章编辑</a></li>
</ol>
<div id="js-wesite-article-comment-display" ng-controller="articleComment" ng-cloak>
    <div class="we7-page-search we7-padding-bottom clearfix">
        <form action="./index.php" method="get" class="form-inline" role="form">
            <div class="form-group">
                <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                    <select class="form-control tpl-category-parent we7-select" id="category_parent" ng-model="order" onchange="changeSort('category')">
                        <option ng-selected ="order == 0" ng-value="0">时间排序</option>
                        <option ng-selected ="order == DESC" ng-value="DESC" >倒序</option>
                        <option ng-selected ="order == ASC" ng-value="ASC">升序</option>
                    </select>
                </div>
                <div class="col-xs-12 col-sm-6 col-md-6 col-lg-6">
                    <select class="form-control tpl-category-parent we7-select" id="category_parent" ng-model="is_read" onchange="changeRead('category')">
                        <option ng-selected ="is_read == 0" ng-value="0">全部</option>
                        <option ng-selected ="is_read == 1" ng-value="1" >已回复</option>
                        <option ng-selected ="is_read == 2" ng-value="2">未回复</option>
                    </select>
                </div>
            </div>
        </form>
    </div>
    <div class="panel we7-panel" id="">
        <div class="panel-heading">
            <span>全部留言</span>
            <span class="pull-right">操作</span>
        </div>
        <div class="panel-body">
            <div class="article-reply-item" ng-repeat="comment in articleList">
                <div class="media ">
                    <div class="media-left">
                        <a href="javascript:;">
                            <img class="media-object reply-logo" ng-src="comment.avatar">
                        </a>
                    </div>
                    <div class="media-body">
                        <h4 class="media-heading reply-people">{{comment.username}}</h4>
                        <p class="reply-content">{{comment.content}}</p>
                        <p class="reply-time">{{comment.createtime}}</p>
                    </div>
                    <div class="media-right">
                        <a href="javascript:;" ng-click="replyarticle(comment.id)" class="color-default">回复</a>
                    </div>
                </div>
                <div class="reply-list">


                    <div class="reply-item" ng-repeat="son_comment in comment.son_comment">
                        <div class="reply-item-head">
                            {{son_comment.username}}
                        </div>
                        <div class="reply-item-content">
                            {{son_comment.content}}
                        </div>
                    </div>
                </div>

                <div class="reply-editor hide" id = "reply-{{comment.id}}">
                    <div class="reply-editor-head">
                        回复该评论
                    </div>
                    <div class="reply-editor-content">
                        <textarea  ng-model="content" cols="30" rows="10" class="form-control"></textarea>
                        <div class="reply-editor-emoji">
                            <i class="fa fa-github-alt"> </i>
                        </div>
                    </div>
                    <div class="reply-editor-action">
                        <button class="btn btn-primary" ng-click="send(comment.id, content)">发送 </button>
                        <button class="btn btn-default" ng-click="cancel(comment.id)">取消</button>
                    </div>
                </div>
            </div>
        </div>
        <div class="text-right we7-margin-top">
            {$pager}
        </div>
    </div>
</div>
<script>
	angular.module('wesiteApp').value('config', {
		articleId:"{$articleId}",
		order:"{$order}",
		is_comment:"{$is_comment}",
		articleList: {php echo !empty($article_lists) ? json_encode($article_lists) : 'null'},
        links :{
			reply: "{php echo url('site/article/add_comment')}",
        }
	});
	angular.bootstrap($('#js-wesite-article-comment-display'), ['wesiteApp']);
</script>
{template 'common/footer'}